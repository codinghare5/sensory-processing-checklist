---
layout: layouts/base.njk
permalink: /questionnaire/
templateClass: tmpl-post
eleventyNavigation:
  key: Questionnaire
  order: 2
---

{# START navigation between tabs #}
<nav>
  <div class="nav nav-tabs" id="nav-tab" role="tablist">
{% for sense in questions %}
    <button 
        class="nav-link{% if loop.first %} active{% endif %}" 
        id="nav-{{ sense.sense | lower }}-tab" 
        data-bs-toggle="tab" 
        data-bs-target="#nav-{{ sense.sense | lower }}" 
        type="button" 
        role="tab" 
        aria-controls="nav-{{ sense.sense | lower }}" 
        aria-selected="{% if loop.first %}true{% else %}false{% endif %}">
          {{ sense.sense }}
    </button>
{% endfor %}
  </div>
</nav>
{# END navigation between tabs #}

{# START of the tab, main container #}
{# this part should occure only once, so it is outside of the loop #}
<div class="tab-content" id="nav-tabContent" style="margin-top: 42px;">
{% for sense in questions %}
  {# START the tab's contents #}
  <div class="tab-pane fade{% if loop.first %} show active{% endif %}" 
    id="nav-{{ sense.sense | lower }}" 
    role="tabpanel" 
    aria-labelledby="nav-{{ sense.sense | lower }}-tab">
    {# very important - it is the unique id of the parent #}
    {# START main accordion, as a row #}
    <div class="accordion row" id="accordionExample-{{ sense.sense | lower }}">
      {% set outerLoop = loop %}
      {# START items in the sidebar, left column, responsive #}
      <div class="col-sm-3">
        {% for meta in sense.metacategories %}
          <div class="accordion-item ">
            <h2 class="accordion-header" id="heading-{{ sense.sense | lower }}-{{ loop.index }}">
              <button class="accordion-button collapsed" 
                type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#collapse-{{ sense.sense | lower }}-{{ loop.index }}" 
                aria-expanded="false" 
                aria-controls="collapse-{{ sense.sense | lower }}-{{ loop.index }}">
                {{ meta.name }}
              </button>
            </h2>
          </div>
        {% endfor %}
      </div>
      {# END items in sidebar #}

      {# this is the body inside accordion, the right colun, responsive #}
      <div class="col-sm-9 border border-1">
        {% for meta in sense.metacategories %}
        {# <p style="margin-left: 10px;">Meta name: {{ meta.name | lower }}</p> #}
        {# this whole part collapses on sidebar button/parent click #}
        {# id= data-bs-target/aria-controls of the sidebar buttons #}
        <div id="collapse-{{ sense.sense | lower }}-{{ loop.index }}" 
            class="accordion-collapse collapse col-sm-9" 
            aria-labelledby="bodyAccorcionHeading"
            {# points out to id of the accordion parent from the sidebar #}
            data-bs-parent="#accordionExample-{{ sense.sense | lower }}">
          {# accordion wrapper for categories #}
          <div class="accordion-body">
            {# 1. we are inside metacategories loop -> id= sense-loop.index #}
            {#    and this is enought for the accordion below to be unique #}
            {#    see No 2. for more details #}
            <div class="accordion" id="{{ sense.sense | lower}}-{{ loop.index }}">
              {# 2. we need to pass loop.index one layer down #}
              {#    for accordion's children to function properly #}
              {#    so let's set new variable #}
              {#    see No 3. for more details #}
              {% set metaLoop = loop %}
              {% for item in meta.categories %}
              {# <p style="margin-left: 20px;">Cat: {{ item.category | lower }}</p> #}
                <div class="accordion-item">
                  <h2 class="accordion-header" id="heading-{{ sense.sense | lower }}-{{ loop.index }}-{{ item.index }}">
                    <button class="accordion-button collapsed" 
                      type="button" 
                      data-bs-toggle="collapse" 
                      data-bs-target="#body-{{ sense.sense | lower }}-{{ loop.index }}-{{ item.index }}" 
                      aria-expanded="false" 
                      aria-controls="body-{{ sense.sense | lower }}-{{ loop.index }}-{{ item.index }}">
                      {{ item.category }}
                    </button>
                  </h2>
                  <div id="body-{{ sense.sense | lower }}-{{ loop.index }}-{{ item.index }}" 
                    class="accordion-collapse collapse" 
                    aria-labelledby="headingOne"
                     {# 3. set the parent with the correct id from the outer loop #}
                     {#     eg. vision-4 #}
                     {#     senses are unique and metacategory number is enought for the accordion to work #}
                    data-bs-parent="#{{ sense.sense | lower}}-{{ metaLoop.index }}">
                    {% for question in item.questions %}
                      <div class="accordion-body">
                        <strong>{{ question }}</strong>
                      </div>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
      {# END this is the body inside accordion #}
    </div>
    {# END main accordion #}
  </div>
  {# END the tab's contents #}
{% endfor %}
</div>
{# END of the tab #}

{# Main loop, good for testing the json file
{% for sense in questions %}
  {% for meta in sense.metacategories %}
  <p style="margin-left: 50px;">Meta name: {{ meta.name | lower }}</p>
    {% for item in meta.categories %}
    <p style="margin-left: 100px;">Cat: {{ item.category | lower }}</p>
      {% for question in item.questions %}
      <p style="margin-left: 150px;">Q: {{ question }}</p>
      {% endfor %}
    {% endfor %}
  {% endfor %}
{% endfor %} 
#}

{# Demo Accordion, for testing purposes
<div class="accordion" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button class="accordion-button" 
        type="button" 
        data-bs-toggle="collapse" 
        data-bs-target="#collapseOne" 
        aria-expanded="true" 
        aria-controls="collapseOne">
        Accordion Item #1
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>This is the first item's accordion body.</strong> It is shown by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingTwo">
      <button class="accordion-button collapsed" 
      type="button" 
      data-bs-toggle="collapse" 
      data-bs-target="#collapseTwo" 
      aria-expanded="false" 
      aria-controls="collapseTwo">
        Accordion Item #2
      </button>
    </h2>
    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
      </div>
    </div>
  </div>
</div> #}